# ì œ 2ì¥. í…ŒìŠ¤íŠ¸í™˜ê²½ êµ¬ì„±í•˜ê¸°

### ì½”ë“œí˜• ì¸í”„ë¼(IaC, Infrastructure as Code)

<img src="https://user-images.githubusercontent.com/101400894/222675808-7302e8ee-4b03-4b5b-b7ff-23a5800dc9f6.png" alt="image" style="zoom:80%;" align="left"/>

ì½”ë“œë¡œ í•˜ë“œì›¨ì–´ë¥¼ ì„¤ì •í•˜ê³ , ìš´ì˜ì²´ì œë¥¼ ì„¤ì¹˜í•˜ê³ , ë„¤íŠ¸ì›Œí¬ë¥¼ êµ¬ì„±í•˜ê³ , ê°œë°œ í™˜ê²½ì„ êµ¬ì¶•í•˜ëŠ” ê²ƒ

ì¦‰, **ì½”ë“œë¡œ ì¸í”„ë¼ë¥¼ ì†Œí”„íŠ¸ì›¨ì–´ì²˜ëŸ¼ ë‹¤ë£° ìˆ˜ ìˆìŒ.**

+ ì‚¬ìš©ìê°€ ëª¨ë‘ ë™ì¼í•œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥, ë¬¸ì œ ë°œìƒ ì‹œ ëª‡ ë²ˆì˜ ëª…ë ¹ ì‹¤í–‰ë§Œìœ¼ë¡œ í™˜ê²½ì„ ìƒˆê²ƒì²˜ëŸ¼ ë‹¤ì‹œ êµ¬ì„± ê°€ëŠ¥



## í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ìë™ìœ¼ë¡œ êµ¬ì„±í•˜ëŠ” ë„êµ¬

+ ë² ì´ê·¸ëŸ°íŠ¸(Vagrant)ëŠ” ê°€ìƒí™” ì†Œí”„íŠ¸ì›¨ì–´ì¸ ë²„ì¶”ì–¼ ë°•ìŠ¤



### ë²„ì¶”ì–¼ ë°•ìŠ¤

**ê°€ìƒí™” ì†Œí”„íŠ¸ì›¨ì–´ë¡œ ì˜¤ë¼í´ì—ì„œ ë°°í¬**

+ í˜„ì¡´í•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ ìš´ì˜ì²´ì œë¥¼ ê²ŒìŠ¤íŠ¸ ìš´ì˜ì²´ì œë¡œ ì‚¬ìš©ê°€ëŠ¥
+ í™•ì¥íŒ©ì„ ì œì™¸í•˜ë©´ ì•„ë¬´ëŸ° ì œí•œì—†ì´ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ë¬´ë£Œë¡œ ì´ìš©



#### ë² ì´ê·¸ëŸ°íŠ¸

+ ì‚¬ìš©ìì˜ ìš”êµ¬ì— ë§ê²Œ ì‹œìŠ¤í…œ ìì›ì„ í• ë‹¹, ë°°ì¹˜, ë°°í¬í•´ ë‘ì—ˆë‹¤ê°€ í•„ìš”í• ë•Œ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìƒíƒœë¡œ ë§Œë“¦
+ **í”„ë¡œë¹„ì €ë‹**
  + í•„ìš”í• ë•Œ í™˜ê²½ì„ ë§¤ìš° ì‰½ê³  ê°„ë‹¨í•˜ê²Œ êµ¬í˜„ ê°€ëŠ¥



#### ë² ì´ê·¸ëŸ°íŠ¸ êµ¬ì„±, í…ŒìŠ¤íŠ¸

cmdì—ì„œ ë² ì´ê·¸ëŸ°íŠ¸ ì‹¤í–‰



+ **vagrant init** : í”„ë¡œë¹„ì €ë‹ì„ ìœ„í•œ ê¸°ì´ˆíŒŒì¼ì„ ìƒì„±
+ **vagrant up** : Vagrantifileì„ ì½ì–´ ë“¤ì—¬ í”„ë¡œë¹„ì €ë‹ì„ ì§„í–‰
+ **vagrant halt** : ë² ì´ê·¸ëŸ°íŠ¸ì—ì„œ ë‹¤ë£¨ëŠ” ê°€ìƒë¨¸ì‹  ì¢…ë£Œ
+ **vagrant destory** : ë² ì´ê·¸ëŸ°íŠ¸ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê°€ìƒë¨¸ì‹  ì‚­ì œ
+ **vagrant ssh** : ë² ì´ê·¸ëŸ°íŠ¸ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê°€ìƒ ë¨¸ì‹ ì— sshë¡œ ì ‘ì†
+ **vagrant provision** : ë² ì´ê·¸ëŸ°íŠ¸ì—ì„œ ê°€ìƒë¨¸ì‹ ì— ë³€ê²½ëœ ì„¤ì •ì„ ì ìš©



1. cmdì—ì„œ vagrant init
2.  config.vm.box = "base"í™•ì¸ (Vagrantfile)
3. vagrant up
   + ì—ëŸ¬ : ì„¤ì¹˜í•˜ë ¤ëŠ” ì´ë¯¸ì§€ê°€ 'base'ë¡œ ëª…ì‹œë¼ ìˆìœ¼ë‚˜ ë² ì´ê·¸ëŸ°íŠ¸ê°€ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì°¾ì§€ëª»í•´ ë°œìƒ
4. config.vm.box = "sysnet4admin/CentOS-k8s"
   + ë² ì´ê·¸ëŸ°íŠ¸ í´ë¼ìš°ë“œì— ì˜¬ë ¤ì§„ ì´ë¯¸ì§€ ì¤‘ ìœ„ì˜ ì´ë¯¸ì§€ë¥¼ ë°›ì•„ì˜¤ê¸°
   + ì¿ ë²„ë„¤í‹°ìŠ¤ ì‹¤ìŠµì— í¬í•¨ëœ ì„¤ì • ë³€ê²½ í¬í•¨
5. vagrant up
6. ë²„ì¶”ì–¼ë°•ìŠ¤ì— ê°€ìƒë¨¸ì‹ ì´ ì œëŒ€ë¡œ ìƒì„±ëëŠ”ì§€ í™•ì¸
7. vagrant ssh(ì„¤ì¹˜í•œ Cent OS ì ‘ì†)
8. uptime  ,   cat /etc/redhat-release
   - ì„¤ì¹˜ê°€ ì •ìƒì ìœ¼ë¡œ ì´ë¤„ì¡ŒëŠ”ì§€ CentOS ì‹¤í–‰ì‹œê°„(uptime)ê³¼ ìš´ì˜ì²´ì œì˜ ì¢…ë¥˜(cat /etc/redhat-release) í™•ì¸
9. exit  ,  vagrant destory -f
   - CentOSê°€ ë² ì´ê·¸ëŸ°íŠ¸ë¡œ ë²„ì¶”ì–¼ ë°•ìŠ¤ì— ê°„ë‹¨í•˜ê²Œ ì„¤ì¹˜ë¨
   - ê°€ìƒë¨¸ì‹  ì‚­ì œ
   - ì ‘ì†í•œ ê°€ìƒë¨¸ì‹  ë‚˜ê°€ê¸°(exit)
   - ì„¤ì¹˜ëœ ê°€ìƒë¨¸ì‹  ì‚­ì œ(vagrant destory -f)





## ë² ì´ê·¸ëŸ°íŠ¸ë¡œ í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì¶•í•˜ê¸°

### ê°€ìƒë¨¸ì‹ ì— í•„ìš”í•œ ì„¤ì • ìë™ìœ¼ë¡œ êµ¬ì„±

+ ìœ„ì˜ ê²½ìš° Vagrantfileì— ê¸°ì¡´ì— ìˆë˜ ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ ê°€ìƒë¨¸ì‹  ìƒì„±
+ ì´ë²ˆì—ëŠ” Vagrantfile ì‘ì„±



```
# -*- mode: ruby -*-
# vi: set ft=ruby :
Vagrant.configure("2") do |config| 
  config.vm.define "m-k8s" do |cfg|
    cfg.vm.box = "sysnet4admin/CentOS-k8s"
    cfg.vm.provider "virtualbox" do |vb|
      vb.name = "m-k8s(github_SysNet4Admin)"
      vb.cpus = 2
      vb.memory = 2048
      vb.customize ["modifyvm", :id, "--groups", "/k8s-SM(github_SysNet4Admin)"]
    end
    cfg.vm.host_name = "m-k8s"
    cfg.vm.network "private_network", ip: "192.168.1.10"
    cfg.vm.network "forwarded_port", guest: 22, host: 60010, auto_correct: true, id: "ssh"
    cfg.vm.synced_folder "../data", "/vagrant", disabled: true
  end
end
```

+ 1~2
  + ì—ë””í„°ì— í˜„ì¬ íŒŒì¼ì´ ë£¨ë¹„ì„ì„ ì¸ì‹í•˜ê²Œ í•˜ëŠ” í˜¸í™˜ì½”ë“œ
  + ft ëŠ” íŒŒì¼ì¢…ë¥˜(filetype) ì•½ì
+ 3
  + "2"ëŠ” ë² ì´ê·¸ëŸ°íŠ¸ì—ì„œ ë£¨ë¹„ë¡œ ì½”ë“œë¥¼ ì½ì–´ ë“¤ì—¬ ì‹¤í–‰í• ë•Œ ì‘ë™í•˜ëŠ” api ë²„ì „
  + do |config| ëŠ” ë² ì´ê·¸ëŸ°íŠ¸ ì„¤ì •ì˜ ì‹œì‘ì„ ì•Œë¦¼
+ 4
  + ë²„ì¶”ì–¼ë°•ìŠ¤ì—ì„œ ë³´ì´ëŠ” ê°€ìƒë¨¸ì‹ ì„ "m-k8s"ë¡œ ì •ì˜
  + do |cfg|ë¥¼ ì¶”ê°€í•´ ì›í•˜ëŠ” ì„¤ì •ìœ¼ë¡œ ë³€ê²½
+ 5
  + ê¸°ë³¸ê°’ config.vm.boxë¥¼ do |cfg|ì— ì ìš©í•œ ë‚´ìš©ì„ ë°›ì•„ cfg.vm.boxë¡œ ë³€ê²½
+ 6
  + ë² ì´ê·¸ëŸ°íŠ¸ì˜ í”„ë¡œë°”ì´ë”ê°€ ë²„ì¶”ì–¼ë°•ìŠ¤ë¼ëŠ” ê²ƒì„ ì •ì˜
  + í”„ë¡œë°”ì´ë”ëŠ” ë² ì´ê·¸ëŸ°íŠ¸ë¥¼ í†µí•´ ì œê³µë˜ëŠ” ì½”ë“œê°€ ì‹¤ì œë¡œ ê°€ìƒë¨¸ì‹ ìœ¼ë¡œ ë°°í¬ë˜ê²Œ í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´
  + ë²„ì¶”ì–¼ë°•ìŠ¤ê°€ ì—¬ê¸°ì— í•´ë‹¹
  + ë²„ì¶”ì–¼ë°•ìŠ¤ì—ì„œ í•„ìš”í•œ ì„¤ì •ì„ ì •ì˜ (do |vb|)
+ 7~11
  + ë²„ì¶”ì–¼ ë°•ìŠ¤ì— ìƒì„±í•œ ê°€ìƒë¨¸ì‹ ì˜ ì´ë¦„, cpuìˆ˜, ë©”ëª¨ë¦¬ í¬ê¸°, ì†Œì†ëœ ê·¸ë£¹ì„ ëª…ì‹œ
  + ë§ˆì§€ë§‰ì— endë¥¼ ë„£ì–´ ë²„ì¶”ì–¼ ë°•ìŠ¤ ì„¤ì •ì„ ëëƒ„
+ 12
  + ê°€ìƒë¨¸ì‹  ìì²´ì— ëŒ€í•œ ì„¤ì •
  + do |config| ì— ì†í•œ ì‘ì—…
+ 13
  + í˜¸ìŠ¤íŠ¸ ì „ìš© ë„¤íŠ¸ì›Œí¬ë¥¼ private_networkë¡œ ì„¤ì •
  + eth1 ì¸í„°í˜ì´ìŠ¤ë¥¼ í˜¸ìŠ¤íŠ¸ ì „ìš©ìœ¼ë¡œ êµ¬ì„±
    + 192.168.1.10 : ì¼ë°˜ì ìœ¼ë¡œ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì˜ ì™¸ë¶€ ê²Œì´íŠ¸ì›¨ì´ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì—¬ëŸ¬ ë²ˆ Wi-Fi ë¬´ì„  ë¼ìš°í„° ë˜ëŠ” ë¼ìš°íŒ… ê¸°ëŠ¥ì´ ìˆëŠ” ìŠ¤ìœ„ì¹˜
+ 14
  + ssh í†µì‹ ì€ í˜¸ìŠ¤íŠ¸ 60010ë²ˆì„ ê²ŒìŠ¤íŠ¸ 22ë²ˆìœ¼ë¡œ ì „ë‹¬ë˜ë„ë¡ êµ¬ì„±
  + í˜¹ì‹œëª¨ë¥¼ ì¤‘ë³µì„ ìœ„í•´ auto_correct : trueë¡œ ì„¤ì •
  + í¬íŠ¸ê°€ ì¤‘ë³µë˜ë©´ í¬íŠ¸ê°€ ìë™ìœ¼ë¡œ ë³€ê²½ë˜ë„ë¡í•¨
+ 15
  + í˜¸ìŠ¤íŠ¸(pc ë˜ëŠ” ë…¸íŠ¸ë¶)ì™€ ê²ŒìŠ¤íŠ¸(ê°€ìƒ ë¨¸ì‹ ) ì‚¬ì´ì— ë””ë ‰í„°ë¦¬ ë™ê¸°í™”ê°€ ì´ë¤„ì§€ì§€ ì•Šê²Œ ì„¤ì •(disabled:true)
+ 16~17
  + do |config| , do |cfg| end



ğŸ“Œssh ì„¤ì •

+ ë² ì´ê·¸ëŸ°íŠ¸ì—ì„œ ssh ì„œë¹„ìŠ¤ì˜ ê¸°ë³¸ í¬íŠ¸ì¸ 22ë²ˆì„ id: "ssh"ë¡œ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ì¤‘ë³µëœ 2ê°œì˜ í¬íŠ¸ë¡œ ì„¤ì •
  + ìê¸°ìì‹ (127.0.0.1)ì˜ 2222ë²ˆ í¬íŠ¸
  + ëª¨ë“  ip(0.0.0.0)ì˜ 60010ë²ˆ í¬íŠ¸
  + ê¸°ëŠ¥ì  ë¬¸ì œëŠ” ì—†ì§€ë§Œ ëª…ì‹œì ìœ¼ë¡œ ì¢‹ì§€ ëª»í•¨



ğŸ“Œ**SSHë€?**

SSHëŠ” Secure Shellì˜ ì¤„ì„ë§ë¡œ, ì›ê²© í˜¸ìŠ¤íŠ¸ì— ì ‘ì†í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë³´ì•ˆ í”„ë¡œí† ì½œì…ë‹ˆë‹¤.

(*Shell(ì‰˜): ëª…ë ¹ì–´ì™€ í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•  ë•Œ ì“°ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§í•©ë‹ˆë‹¤. ì¢€ ë” ìì„¸í•˜ê²Œ í‘œí˜„í•˜ìë©´ ì»¤ë„ê³¼ ì‚¬ìš©ì ê°„ì˜ ë‹¤ë¦¬ ì—­í• ì„ í•˜ëŠ” ê²ƒìœ¼ë¡œ, ì‚¬ìš©ìë¡œë¶€í„° ëª…ë ¹ì„ ë°›ì•„ ê·¸ê²ƒì„ í•´ì„í•˜ê³  ì‹¤í–‰í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. í”íˆ ê²€ì€ ë°”íƒ•ì— í° ê¸€ìê°€ ë‚˜ì˜¤ëŠ” ëª…ë ¹ì–´ ì…ë ¥ í™˜ê²½ì„ ë– ì˜¬ë¦¬ì‹œë©´ ë©ë‹ˆë‹¤.)

ê¸°ì¡´ ì›ê²© ì ‘ì†ì€ â€˜í…”ë„·(Telnet)â€™ì´ë¼ëŠ” ë°©ì‹ì„ ì‚¬ìš©í–ˆëŠ”ë°, ì•”í˜¸í™”ë¥¼ ì œê³µí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë³´ì•ˆìƒ ì·¨ì•½í•˜ë‹¤ëŠ” ë‹¨ì ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ì‹¤ì œë¡œ WireSharkê°™ì€ íŒ¨í‚· ë¶„ì„ í”„ë¡œê·¸ë¨ì„ ì´ìš©í•˜ë©´ ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ì›ê²© ì ‘ì† ê³¼ì •ì—ì„œ ì˜®ê²¨ì§€ëŠ” ë¹„ë°€ë²ˆí˜¸ë‚˜ íŒŒì¼ ë‚´ìš© ë“±ì˜ ë°ì´í„°ë¥¼ íƒˆì·¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë•Œë¬¸ì— ì´ë¥¼ ì•”í˜¸í™”í•˜ëŠ” SSH ê¸°ìˆ ì´ ë“±ì¥í–ˆê³ , í˜„ì¬ ì›ê²© ì ‘ì† ë³´ì•ˆì„ ìœ„í•œ í•„ìˆ˜ì ì¸ ìš”ì†Œë¡œ ìë¦¬ì¡ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” ì„œë²„ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì›ê²© ì ‘ì†ì„ í•´ì„œ ì ‘ê·¼í•˜ê³  ì‚¬ìš©í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ NBPë‚˜ AWSì™€ ê°™ì€ CSP(Cloud Service Provider, í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ê³³)ì—ì„œ ì„œë²„ ìƒì„±ì‹œ í•„ìˆ˜ì ìœ¼ë¡œ SSH ë³´ì•ˆ ê³¼ì •ì„ ê±°ì¹˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

[ssh](https://library.gabia.com/contents/infrahosting/9002/)



#### ip í™•ì¸

+ ethëŠ” ë¦¬ëˆ…ìŠ¤ì˜ ì´ë”ë„· ì´ë¦„ì˜ prefix

```
vagrant ssh //ssh ì ‘ì†
ip addr show eth1 //ipê°€ ì œëŒ€ë¡œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸(í•´ë‹¹ ê°€ìƒë¨¸ì‹ )
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 08:00:27:5f:4f:86 brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.10/24 brd 192.168.1.255 scope global noprefixroute eth1
       valid_lft forever preferred_lft forever
    inet6 fe80::a00:27ff:fe5f:4f86/64 scope link
       valid_lft forever preferred_lft forever
```

**ì´ë”ë„·(ETHERNET)**

- ì´ë”ë„·ì€ ì „ ì„¸ê³„ì—ì„œ í­ë„“ê²Œ ì´ìš©ë˜ê³  ìˆëŠ” **ë„¤íŠ¸ì›Œí¬ ê·œê²©**ì…ë‹ˆë‹¤.

- ìš°ë¦¬ì˜ ì»´í“¨í„°ì— íƒ‘ì¬ë˜ì–´ ìˆëŠ” ìœ ì„  ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ëŠ” ê±°ì˜ 'ì´ë”ë„·'ì´ë¼ê³  ë´ë„ ë¬´ë°©í•©ë‹ˆë‹¤.

- ì´ë”ë„·ì€ ê° ê¸°ê¸°ë“¤ì˜ ê³ ìœ ì˜ ì£¼ì†Œ **MAC ì£¼ì†Œë¥¼** ê°€ì§€ê³  í˜¸ìŠ¤íŠ¸ ê°„ì˜ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆëŠ” ë°©ì‹



### ê°€ìƒë¨¸ì‹ ì— ì¶”ê°€ íŒ¨í‚¤ì§€ ì„¤ì¹˜



```
# -*- mode: ruby -*-
# vi: set ft=ruby :
Vagrant.configure("2") do |config| 
  config.vm.define "m-k8s" do |cfg|
    cfg.vm.box = "sysnet4admin/CentOS-k8s"
    cfg.vm.provider "virtualbox" do |vb|
      vb.name = "m-k8s(github_SysNet4Admin)"
      vb.cpus = 2
      vb.memory = 2048
      vb.customize ["modifyvm", :id, "--groups", "/k8s-SM(github_SysNet4Admin)"]
    end
    cfg.vm.host_name = "m-k8s"
    cfg.vm.network "private_network", ip: "192.168.1.10"
    cfg.vm.network "forwarded_port", guest: 22, host: 60010, auto_correct: true, id: "ssh"
    cfg.vm.synced_folder "../data", "/vagrant", disabled: true   
    cfg.vm.provision "shell", path: "install_pkg.sh" #add provisioning script
  end
end
```

+ 16
  + vm.provision "shell" êµ¬ë¬¸ìœ¼ë¡œ ê²½ë¡œ(path)ì— ìˆëŠ” install_pkg.shë¥¼ ê²ŒìŠ¤íŠ¸(CentOS) ë‚´ë¶€ì—ì„œ í˜¸ì¶œí•´ ì‹¤í–‰ë˜ë„ë¡ í•¨



```
yum install epel-release -y
yum install vim-enhanced -y
```

+ EPEL(Extra Packages for Enterprise Linux) ì €ì¥ì†Œ
+ ì½”ë“œ í•˜ì´ë¼ì´íŠ¸ë¥¼ ìœ„í•œ Vim ì¶”ê°€ê¸°ëŠ¥ ì„¤ì¹˜



#### ì‹¤ì œ í™•ì¸

```
vagrant ssh
yum repolist //repository epel í™•ì¸
vi .bashrc // ë¬¸ë²• í•˜ì´ë¼ì´íŠ¸ í™•ì¸
```



### ê°€ìƒë¨¸ì‹  ì¶”ê°€ë¡œ êµ¬ì„±í•˜ê¸°

<img src="https://user-images.githubusercontent.com/101400894/222720992-1665b73d-00fc-4342-a087-f66af5931fef.png" alt="image" style="zoom:67%;" align="left"/>

+ ê¸°ì¡´ ì„¤ì¹˜í•œ ê°€ìƒë¨¸ì‹  ì™¸ì— ê°€ìƒë¨¸ì‹  3ëŒ€ ì¶”ê°€í•˜ê¸°



+ vagrantfile

```
# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config| 
  config.vm.define "m-k8s" do |cfg|
    cfg.vm.box = "sysnet4admin/CentOS-k8s"
    cfg.vm.provider "virtualbox" do |vb|
      vb.name = "m-k8s(github_SysNet4Admin)"
      vb.cpus = 2
      vb.memory = 2048
      vb.customize ["modifyvm", :id, "--groups", "/k8s-SM(github_SysNet4Admin)"]
    end
    cfg.vm.host_name = "m-k8s"
    cfg.vm.network "private_network", ip: "192.168.1.10"
    cfg.vm.network "forwarded_port", guest: 22, host: 60010, auto_correct: true, id: "ssh"
    cfg.vm.synced_folder "../data", "/vagrant", disabled: true   
    cfg.vm.provision "shell", path: "install_pkg.sh"
    cfg.vm.provision "file", source: "ping_2_nds.sh", destination: "ping_2_nds.sh"
    cfg.vm.provision "shell", path: "config.sh"
  end
  
  #=============#
  # Added Nodes #
  #=============#

  (1..3).each do |i|
    config.vm.define "w#{i}-k8s" do |cfg|
      cfg.vm.box = "sysnet4admin/CentOS-k8s"
      cfg.vm.provider "virtualbox" do |vb|
        vb.name = "w#{i}-k8s(github_SysNet4Admin)"
        vb.cpus = 1
        vb.memory = 1024
        vb.customize ["modifyvm", :id, "--groups", "/k8s-SM(github_SysNet4Admin)"]
      end
      cfg.vm.host_name = "w#{i}-k8s"
      cfg.vm.network "private_network", ip: "192.168.1.10#{i}"
      cfg.vm.network "forwarded_port", guest: 22, host: "6010#{i}",auto_correct: true, id: "ssh"
      cfg.vm.synced_folder "../data", "/vagrant", disabled: true
      cfg.vm.provision "shell", path: "install_pkg.sh"
    end
  end
end
```

+ 18(cfg.vm.provision "file", source: "ping_2_nds.sh", destination: "ping_2_nds.sh")
  + íŒŒì¼ì„ ìš´ì˜ì²´ì œì— ì „ë‹¬í•˜ê¸° ìœ„í•´ "shell"ì´ ì•„ë‹Œ "file" êµ¬ë¬¸ìœ¼ë¡œ ë³€ê²½
  + í˜¸ìŠ¤íŠ¸ì— ìˆëŠ” ping_2_nds.shíŒŒì¼ì„ ê²ŒìŠ¤íŠ¸ì˜ í™ˆ ë””ë ‰í„°ë¦¬(/home/vagrant)ë¡œ ì „ë‹¬
+ 19(cfg.vm.provision "shell", path: "config.sh")
  + config.shë¥¼ ê²ŒìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰
+ 26~37
  + 3ëŒ€ì˜ CentOS êµ¬ì„±
  + ë°˜ë³µë¬¸ ì‚¬ìš©(1..3). each, ië¥¼ 1ë¶€í„° 3ì´ ëŒ€ì…ë¨



+ install_pkg.sh

```
yum install epel-release -y
yum install vim-enhanced -y
```



+ ping_2_nds.sh

```
ping 192.168.1.101 -c 3
ping 192.168.1.102 -c 3
ping 192.168.1.103 -c 3
```

+ ì¶”ê°€ë¡œ ì„¤ì¹˜í•œ CentOS 3ëŒ€ë¡œ pingì„ ë³´ë‚´ ë„¤íŠ¸ì›Œí¬ê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ëª…ë ¹
+ -c ì˜µì…˜ì€ pingì„ ëª‡ë²ˆ ë³´ë‚¼ì§€ ê²°ì •



+ config.sh

```
chmod 744 ./ping_2_nds.sh
```

**íŒŒì¼ê¶Œí•œ 744ì˜ ì˜ë¯¸**

+ ping í…ŒìŠ¤íŠ¸ íŒŒì¼ì´ ì—…ë¡œë“œë˜ê³  ë‚œ í›„ì— ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ê¶Œí•œì„ 744ë¡œ ì¤Œ

| êµ¬ë¶„       | ì†Œìœ ì(Owner) | ê·¸ë£¹ ë©¤ë²„(Group) | ê·¸ ì™¸(Other) |
| ---------- | ------------- | ---------------- | ------------ |
| ì½ê¸°(R/+4) | ì˜ˆ            | ì˜ˆ               | ì˜ˆ           |
| ì“°ê¸°(W/+2) | ì˜ˆ            | ì•„ë‹ˆìš”           | ì•„ë‹ˆìš”       |
| ì‹¤í–‰(X/+1) | ì˜ˆ            | ì•„ë‹ˆìš”           | ì•„ë‹ˆìš”       |



#### í•‘í…ŒìŠ¤íŠ¸

```
./ping_2_nds.sh
PING 192.168.1.101 (192.168.1.101) 56(84) bytes of data.
64 bytes from 192.168.1.101: icmp_seq=1 ttl=64 time=1.42 ms
64 bytes from 192.168.1.101: icmp_seq=2 ttl=64 time=0.879 ms
64 bytes from 192.168.1.101: icmp_seq=3 ttl=64 time=1.22 ms

--- 192.168.1.101 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2006ms
rtt min/avg/max/mdev = 0.879/1.175/1.421/0.225 ms
PING 192.168.1.102 (192.168.1.102) 56(84) bytes of data.
64 bytes from 192.168.1.102: icmp_seq=1 ttl=64 time=1.53 ms
64 bytes from 192.168.1.102: icmp_seq=2 ttl=64 time=1.63 ms
64 bytes from 192.168.1.102: icmp_seq=3 ttl=64 time=0.908 ms

--- 192.168.1.102 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2009ms
rtt min/avg/max/mdev = 0.908/1.361/1.639/0.326 ms
PING 192.168.1.103 (192.168.1.103) 56(84) bytes of data.
64 bytes from 192.168.1.103: icmp_seq=1 ttl=64 time=5.33 ms
64 bytes from 192.168.1.103: icmp_seq=2 ttl=64 time=1.79 ms
64 bytes from 192.168.1.103: icmp_seq=3 ttl=64 time=0.501 ms

--- 192.168.1.103 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2010ms
rtt min/avg/max/mdev = 0.501/2.540/5.330/2.042 ms
```

